const origDigest = crypto.subtle.digest;
crypto.subtle.digest = async function(algo, data) {
    const text = new TextDecoder().decode(data);
    console.log("[DEBUG] hashing input:", text);

    // Lanjutkan hashing normal
    const result = await origDigest.apply(this, arguments);

    // Convert ArrayBuffer -> hex string
    const hex = Array.from(new Uint8Array(result))
                     .map(b => b.toString(16).padStart(2, '0'))
                     .join('');
    console.log("[DEBUG] hash result:", hex);
    return result;
};
