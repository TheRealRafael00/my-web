// Hook crypto.subtle.digest
const origDigest = crypto.subtle.digest;

crypto.subtle.digest = async function (algo, data) {
    const text = new TextDecoder().decode(data); // plaintext yang lagi di-hash

    const result = await origDigest.apply(this, arguments);

    // Convert ArrayBuffer -> hex string
    const hex = Array.from(new Uint8Array(result))
        .map(b => b.toString(16).padStart(2, '0'))
        .join('');

    console.log("[DEBUG] input:", text, "| SHA256:", hex);

    // TARGET_HASH: ganti string ini dengan hash target dari file (64 hex)
    const TARGET_HASH = "isi_hash_target_64hex_dari_html";

    if (hex === TARGET_HASH) {
        alert("ðŸ”¥ Password ketemu: " + text);
    }

    return result;
};
