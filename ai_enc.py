#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import base64

code = b"""IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIC0qLSBjb2Rpbmc6IHV0Zi04IC0qLQoiIiIKQ2hhdEdQVCBDTEkgZm9yIFRlcm11eCAvIEthbGkgTGludXgKRmVhdHVyZXM6CiAtIE11bHRpcGxlIEFQSSBrZXlzIChzd2l0Y2ggd2l0aCAiY2hhbmdlIE4iKQogLSBTZXR1cCBvbiBmaXJzdCBydW4KIC0gQ29sb3JlZCwgbmVhdCBVSQogLSBDb252ZXJzYXRpb24gaGlzdG9yeQogLSBTYXZlIHNldHRpbmdzIHRvIH4vLmNncHRfY29uZmlnLmpzb24KIC0gQ29tbWFuZHM6IGNoYW5nZSBOLCBrZXlzLCBjbGVhciwgaGlzdG9yeSwgZXhpdCAob3IgcSkKUmVxdWlyZXM6IHB5dGhvbjMsIHBpcCBpbnN0YWxsIG9wZW5haSBjb2xvcmFtYSBweWZpZ2xldAoiIiIKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKaW1wb3J0IHRocmVhZGluZwpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKCiMgPT09PT09PT09PT09PT09PT09PT09IFVTRVItREVGSU5FRCBBUEkgS0VZUyAoeW91IHByb3ZpZGVkIHRoZXNlKSA9PT09PT09PT09PT09PT09PT09PT0KQVBJX0tFWVMgPSBbCiJzay1wcm9qLTljZVFheFNnUklKRGFCaGdrNklMWGl3VXg2eElJT3JRZHZzTUV0bXdPalpUZmR6NG1aZFhMaGctZ1JWT09HdGtabkg0V2hZb0NrVDNCbGJrRkpUODFZbnNOOFlnRnlqOXdFZHhlQkZRUnA3NVgwYUsxRVJ3LVpjSWpVQ1BkNTJqc3dHZFo3SktYLTk3ZXZPUS1pQmI3Qy1Qb2RjQSIsCiJzay1wcm9qLXF5aDBVLWxqWlYzM2Z1RWY4cm4tanZlWGZjb3hYSGR5cFM4OWVZMFlqcGJLRWVIcVNaNk1EYlh0Tm1FMmtZdlYycVNTcHctbUdIVDNCbGJrRkpPN0xZYW9jVFZOUHBhNDkzZFFmNm5zNW95d2xBUng5R0VteWszM3FFelVmNnlxWEFoXzR3LWhtSVJNREZYTTNBdXRrUVVLRHZvQSIsCiJzay1wcm9qLXlXRXdRMmdHWG80VXltNjJLbFV3MjNWYmx1cm9TUWpWeXYyMWFCR20tWU9vTHRSdkJ0X1VBU2tZWjI4WEhtTG5MOF9pcnNmdjhrVDNCbGJrRkpqYkhYZ1JyMDVhVFRDbWlHVmRwbFNOZlYzN28xYzl5angtcU1aQ0ZhMF9tTkpUcWcwNW1oX3JOV3lKaHRqVzdFeEs1X2lxR0RJQSIsCiJzay1wcm9qLWRFWTNXeEE5aU5TTnlQdzF3SVI0Q2lFM01OVVdCOE9XQS10OGhjQW81SFNIX2xNMVlQdFczR2lyOFVCX0trcmx5S0Z0MWFCZkdnVDNCbGJrRkp1NFVRMWN5MzRGNzVrZm9haGpqaTUwVnVoaU04MjdKWFVITDFwUUtsM0FHbDB6QXNhQkRONmd1U0RwRTVCd1dUQm9fMmcyNFFnQSIsCiJzay1wcm9qLWFJTEdWeThReVU2UndTZlRaRVpTQ3dYdUVnanIxaTdOeF9neVNQVkNzaHk0cV8wejI1MlBndUwwa0M4MEhIellnYm91X2wwcEYtVDNCbGJrRkptMlVJSC1FRDBwTm9mc0dHSnJZQXRSdkJUYzBYVXFHS0R2di0xT2VtV3pLYi1hMW9vemRUNHduX1d6VDZXNEdxUjg5aFBVUmlFQSIsCiJzay1wcm9qLWozRHZtOU9ULVlETGktUl9FeW1vNFpoWWQyLVB4MXlmTWx5ZXFKWTRuUDJtdTVhenVYMFNhYm5TaU9wTlpZTlRDTzI1REtuUkN4VDNCbGJrRkpMc09VMnVJNzBkVHRBT3c5N0R4T3RSaGtvWnhtQXpFaTd1eHlkWG1RN25nWDZabU8yVVRLT0l5eVJXLUVLbW41UEo1dUl0T2pBQSIsCiJzay1wcm9qLW9HZnBvZUlXTThxQThlZ1ZudGJ6NzJSWmZ6YjZrZ1oxVkh1c3N5VVJ0Z0YxTUZEVTMybHIzMGVVbk53UGRwWlZFdFFDN0JoX0NhVDNCbGJrRkpkMlY4N1hXd0hzclRVTF9XY3ZYRk83YUtkTFpyXzVEVC00ekpZbFJjdlZ2Y1dCeFdueVF2VmwtQmpNa0FGa2pyWjdETnYyYjZnQSIsCiJzay1wcm9qLVZCMEh6dzd1cVd3UGVaSlVGRXVoeHZlWmFFdGQzb0tVTE1sLWJZN0NqNnFuQVMtNC1SZUpFLWpycXUxYm84M1Y2UllWNTFrWnBBVDNCbGJrRkpqVVJNZ2VWcHdMUVk1U2ZBNnp3am9MbmxCQnAwMGh1c2pXWFp6SnpLd1RmV0Y0R0V0cTRSNmFpZ09YY0VvUl9xTEVUQVJJUkw0QSIsCl0KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKQ09ORklHX1BBVEggPSBQYXRoLmhvbWUoKSAvICIuY2dwdF9jb25maWcuanNvbiIKSElTVE9SWV9QQVRIID0gUGF0aC5ob21lKCkgLyAiLmNncHRfaGlzdG9yeS5qc29uIgoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gTWluaW1hbCBydW50aW1lIGRlcGVuZGVuY3kgaGFuZGxpbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnRyeToKICAgIGltcG9ydCBvcGVuYWkKZXhjZXB0IEV4Y2VwdGlvbjoKICAgIHByaW50KCJNaXNzaW5nIGRlcGVuZGVuY3kgJ29wZW5haScuIEluc3RhbGwgd2l0aDogcGlwIGluc3RhbGwgb3BlbmFpIikKICAgIHN5cy5leGl0KDEpCgp0cnk6CiAgICBmcm9tIGNvbG9yYW1hIGltcG9ydCBpbml0IGFzIGNvbG9yYW1hX2luaXQsIEZvcmUsIEJhY2ssIFN0eWxlCmV4Y2VwdCBFeGNlcHRpb246CiAgICBwcmludCgiTWlzc2luZyBkZXBlbmRlbmN5ICdjb2xvcmFtYScuIEluc3RhbGwgd2l0aDogcGlwIGluc3RhbGwgY29sb3JhbWEiKQogICAgc3lzLmV4aXQoMSkKCiMgb3B0aW9uYWwsIGZvciBsb2dvCnRyeToKICAgIGltcG9ydCBweWZpZ2xldAogICAgX0hBU19QRklHID0gVHJ1ZQpleGNlcHQgRXhjZXB0aW9uOgogICAgX0hBU19QRklHID0gRmFsc2UKCmNvbG9yYW1hX2luaXQoYXV0b3Jlc2V0PVRydWUpCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSBVdGlsaXR5IGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0KZGVmIG1hc2tfa2V5KGs6IHN0cikgLT4gc3RyOgogICAgIyBtYXNrIG1pZGRsZSBvZiBrZXkgZm9yIGRpc3BsYXkKICAgIGlmIG5vdCBrIG9yIGxlbihrKSA8IDEyOgogICAgICAgIHJldHVybiAiKioqKiIKICAgIHJldHVybiBrWzo2XSArICgiKiIgKiAobGVuKGspIC0gMTIpKSArIGtbLTY6XQoKZGVmIHNhdmVfY29uZmlnKGNmZzogZGljdCk6CiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKENPTkZJR19QQVRILCAidyIpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChjZmcsIGYsIGluZGVudD0yKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBwYXNzCgpkZWYgbG9hZF9jb25maWcoKSAtPiBkaWN0OgogICAgaWYgQ09ORklHX1BBVEguZXhpc3RzKCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkKG9wZW4oQ09ORklHX1BBVEgsICJyIikpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgcmV0dXJuIHt9CiAgICByZXR1cm4ge30KCmRlZiBzYXZlX2hpc3RvcnkoaGlzdG9yeV9saXN0KToKICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4oSElTVE9SWV9QQVRILCAidyIpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChoaXN0b3J5X2xpc3QsIGYsIGluZGVudD0yKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBwYXNzCgpkZWYgbG9hZF9oaXN0b3J5KCk6CiAgICBpZiBISVNUT1JZX1BBVEguZXhpc3RzKCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkKG9wZW4oSElTVE9SWV9QQVRILCAiciIpKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHJldHVybiBbXQogICAgcmV0dXJuIFtdCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSBDb3JlIENoYXQgQ2xpZW50IC0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjbGFzcyBDR1BUQ2xpZW50OgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFwaV9rZXlzKToKICAgICAgICBzZWxmLmFwaV9rZXlzID0gYXBpX2tleXMuY29weSgpCiAgICAgICAgc2VsZi5jZmcgPSBsb2FkX2NvbmZpZygpCiAgICAgICAgc2VsZi5rZXlfaW5kZXggPSBzZWxmLmNmZy5nZXQoImtleV9pbmRleCIsIDApIGlmIHNlbGYuY2ZnLmdldCgia2V5X2luZGV4IikgaXMgbm90IE5vbmUgZWxzZSAwCiAgICAgICAgaWYgc2VsZi5rZXlfaW5kZXggPCAwIG9yIHNlbGYua2V5X2luZGV4ID49IGxlbihzZWxmLmFwaV9rZXlzKToKICAgICAgICAgICAgc2VsZi5rZXlfaW5kZXggPSAwCiAgICAgICAgc2VsZi5zZXRfa2V5KHNlbGYua2V5X2luZGV4KQogICAgICAgIHNlbGYuaGlzdG9yeSA9IGxvYWRfaGlzdG9yeSgpCiAgICAgICAgc2VsZi5zeXN0ZW1fcHJvbXB0ID0gc2VsZi5jZmcuZ2V0KCJzeXN0ZW1fcHJvbXB0IiwgIllvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudC4iKQogICAgICAgIHNlbGYubW9kZWwgPSBzZWxmLmNmZy5nZXQoIm1vZGVsIiwgImdwdC0zLjUtdHVyYm8iKQogICAgICAgIHNlbGYuX3N0b3Bfc3Bpbm5lciA9IEZhbHNlCgogICAgZGVmIHNldF9rZXkoc2VsZiwgaWR4KToKICAgICAgICBzZWxmLmtleV9pbmRleCA9IGludChpZHgpCiAgICAgICAgaWYgc2VsZi5rZXlfaW5kZXggPCAwIG9yIHNlbGYua2V5X2luZGV4ID49IGxlbihzZWxmLmFwaV9rZXlzKToKICAgICAgICAgICAgcmFpc2UgSW5kZXhFcnJvcigiQVBJIGtleSBpbmRleCBvdXQgb2YgcmFuZ2UiKQogICAgICAgIHNlbGYuYXBpX2tleSA9IHNlbGYuYXBpX2tleXNbc2VsZi5rZXlfaW5kZXhdCiAgICAgICAgb3BlbmFpLmFwaV9rZXkgPSBzZWxmLmFwaV9rZXkKICAgICAgICBzZWxmLmNmZ1sna2V5X2luZGV4J10gPSBzZWxmLmtleV9pbmRleAogICAgICAgIHNhdmVfY29uZmlnKHNlbGYuY2ZnKQoKICAgIGRlZiBzaG93X2tleXMoc2VsZik6CiAgICAgICAgb3V0ID0gW10KICAgICAgICBmb3IgaSwgayBpbiBlbnVtZXJhdGUoc2VsZi5hcGlfa2V5cyk6CiAgICAgICAgICAgIG1hcmsgPSAiPC0tIGFjdGl2ZSIgaWYgaSA9PSBzZWxmLmtleV9pbmRleCBlbHNlICIiCiAgICAgICAgICAgIG91dC5hcHBlbmQoZiJbe2l9XSB7bWFza19rZXkoayl9IHttYXJrfSIpCiAgICAgICAgcmV0dXJuICJcbiIuam9pbihvdXQpCgogICAgZGVmIGFkZF90b19oaXN0b3J5KHNlbGYsIHJvbGUsIGNvbnRlbnQpOgogICAgICAgIHNlbGYuaGlzdG9yeS5hcHBlbmQoeyJyb2xlIjogcm9sZSwgImNvbnRlbnQiOiBjb250ZW50fSkKICAgICAgICAjIGxpbWl0IGhpc3RvcnkgbGVuZ3RoCiAgICAgICAgaWYgbGVuKHNlbGYuaGlzdG9yeSkgPiA1MDoKICAgICAgICAgICAgc2VsZi5oaXN0b3J5ID0gc2VsZi5oaXN0b3J5Wy01MDpdCiAgICAgICAgc2F2ZV9oaXN0b3J5KHNlbGYuaGlzdG9yeSkKCiAgICBkZWYgc3Bpbm5lcihzZWxmLCB0ZXh0PSJUaGlua2luZyIpOgogICAgICAgIGNoYXJzID0gInwvLVxcIgogICAgICAgIGkgPSAwCiAgICAgICAgd2hpbGUgbm90IHNlbGYuX3N0b3Bfc3Bpbm5lcjoKICAgICAgICAgICAgcHJpbnQoRm9yZS5DWUFOICsgZiJccnt0ZXh0fSB7Y2hhcnNbaSU0XX0gIiwgZW5kPSIiLCBmbHVzaD1UcnVlKQogICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgdGltZS5zbGVlcCgwLjEyKQogICAgICAgIHByaW50KCJcciIgKyAiICIgKiAobGVuKHRleHQpICsgNCkgKyAiXHIiLCBlbmQ9IiIsIGZsdXNoPVRydWUpCgogICAgZGVmIGNoYXQoc2VsZiwgdXNlcl9tc2cpOgogICAgICAgICMgYXBwZW5kIHVzZXIgbWVzc2FnZSB0byBoaXN0b3J5CiAgICAgICAgc2VsZi5hZGRfdG9faGlzdG9yeSgidXNlciIsIHVzZXJfbXNnKQogICAgICAgIG1lc3NhZ2VzID0gW3sicm9sZSI6ICJzeXN0ZW0iLCAiY29udGVudCI6IHNlbGYuc3lzdGVtX3Byb21wdH1dICsgc2VsZi5oaXN0b3J5CiAgICAgICAgIyBzdGFydCBzcGlubmVyIHRocmVhZAogICAgICAgIHNlbGYuX3N0b3Bfc3Bpbm5lciA9IEZhbHNlCiAgICAgICAgdCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuc3Bpbm5lciwgYXJncz0oIkNoYXRHUFQgaXMgdHlwaW5nIiwpLCBkYWVtb249VHJ1ZSkKICAgICAgICB0LnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3AgPSBvcGVuYWkuQ2hhdENvbXBsZXRpb24uY3JlYXRlKAogICAgICAgICAgICAgICAgbW9kZWw9c2VsZi5tb2RlbCwKICAgICAgICAgICAgICAgIG1lc3NhZ2VzPW1lc3NhZ2VzLAogICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU9MC43LAogICAgICAgICAgICAgICAgbWF4X3Rva2Vucz0xNTAwLAogICAgICAgICAgICAgICAgbj0xLAogICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYuX3N0b3Bfc3Bpbm5lciA9IFRydWUKICAgICAgICAgICAgdC5qb2luKCkKICAgICAgICAgICAgYW5zd2VyID0gcmVzcC5jaG9pY2VzWzBdLm1lc3NhZ2VbJ2NvbnRlbnQnXS5zdHJpcCgpCiAgICAgICAgICAgIHNlbGYuYWRkX3RvX2hpc3RvcnkoImFzc2lzdGFudCIsIGFuc3dlcikKICAgICAgICAgICAgcmV0dXJuIGFuc3dlcgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5fc3RvcF9zcGlubmVyID0gVHJ1ZQogICAgICAgICAgICB0LmpvaW4oKQogICAgICAgICAgICByZXR1cm4gZiJbRVJST1JdIHtzdHIoZSl9IgoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gSW50ZXJhY3RpdmUgQ0xJIC0tLS0tLS0tLS0tLS0tLS0tLS0tLQpCT1JERVIgPSBGb3JlLkJMVUUgKyAoIj0iICogNzIpICsgU3R5bGUuUkVTRVRfQUxMCgpkZWYgcHJpbnRfaGVhZGVyKGNsaWVudDogQ0dQVENsaWVudCk6CiAgICBvcy5zeXN0ZW0oJ2NsZWFyJyBpZiBvcy5uYW1lICE9ICdudCcgZWxzZSAnY2xzJykKICAgIGlmIF9IQVNfUEZJRzoKICAgICAgICBiYW5uZXIgPSBweWZpZ2xldC5maWdsZXRfZm9ybWF0KCJDIEcgUCBUIiwgZm9udD0ic2xhbnQiKQogICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBiYW5uZXIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBlbHNlOgogICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyAiPT09IEMgRyBQIFQgLSBDaGF0R1BUIENMSSA9PT0iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgcHJpbnQoQk9SREVSKQogICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyAiQ29ubmVjdGVkIEtleToiICsgU3R5bGUuUkVTRVRfQUxMLAogICAgICAgICAgRm9yZS5NQUdFTlRBICsgbWFza19rZXkoY2xpZW50LmFwaV9rZXkpLCBmIihpbmRleCB7Y2xpZW50LmtleV9pbmRleH0pIikKICAgIHByaW50KEZvcmUuWUVMTE9XICsgIk1vZGVsOiIgKyBTdHlsZS5SRVNFVF9BTEwsIEZvcmUuTUFHRU5UQSArIGNsaWVudC5tb2RlbCkKICAgIHByaW50KEZvcmUuWUVMTE9XICsgIlN5c3RlbSBwcm9tcHQ6IiArIFN0eWxlLlJFU0VUX0FMTCwgRm9yZS5NQUdFTlRBICsgY2xpZW50LnN5c3RlbV9wcm9tcHQpCiAgICBwcmludChCT1JERVIpCiAgICBwcmludChGb3JlLkNZQU4gKyAiQ29tbWFuZHM6ICIgKyBTdHlsZS5SRVNFVF9BTEwgKwogICAgICAgICAgImNoYW5nZSBOICB8IGtleXMgfCBjbGVhciB8IGhpc3RvcnkgfCBzZXRwcm9tcHQgfCBzZXRtb2RlbCB8IGV4aXQvcSIpCiAgICBwcmludChCT1JERVIpCgpkZWYgaW50ZXJhY3RpdmVfbG9vcChjbGllbnQ6IENHUFRDbGllbnQpOgogICAgcHJpbnRfaGVhZGVyKGNsaWVudCkKICAgIHRyeToKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBwcm9tcHQgPSBpbnB1dChGb3JlLldISVRFICsgIlxuWW91PiAiICsgU3R5bGUuUkVTRVRfQUxMKS5zdHJpcCgpCiAgICAgICAgICAgIGV4Y2VwdCAoRU9GRXJyb3IsIEtleWJvYXJkSW50ZXJydXB0KToKICAgICAgICAgICAgICAgIHByaW50KCJcbkV4aXRpbmcuLi4iKQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgIGlmIG5vdCBwcm9tcHQ6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgIyBDb21tYW5kcwogICAgICAgICAgICBpZiBwcm9tcHQubG93ZXIoKSBpbiAoImV4aXQiLCAicSIpOgogICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArICJCeWUhIiArIFN0eWxlLlJFU0VUX0FMTCkKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBpZiBwcm9tcHQubG93ZXIoKS5zdGFydHN3aXRoKCJjaGFuZ2UgIik6CiAgICAgICAgICAgICAgICBwYXJ0cyA9IHByb21wdC5zcGxpdCgpCiAgICAgICAgICAgICAgICBpZiBsZW4ocGFydHMpID49IDIgYW5kIHBhcnRzWzFdLmlzZGlnaXQoKToKICAgICAgICAgICAgICAgICAgICBpZHggPSBpbnQocGFydHNbMV0pCiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2tleShpZHgpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIlN3aXRjaGVkIHRvIGtleSBpbmRleCB7aWR4fSAoe21hc2tfa2V5KGNsaWVudC5hcGlfa2V5KX0pIikKICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgZiJGYWlsZWQgdG8gc3dpdGNoIGtleToge2V9IikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyAiVXNhZ2U6IGNoYW5nZSBOICAgKE4gPSBrZXkgaW5kZXggbnVtYmVyKSIpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgaWYgcHJvbXB0Lmxvd2VyKCkgPT0gImtleXMiOgogICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5DWUFOICsgIkF2YWlsYWJsZSBBUEkga2V5czoiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICAgICAgcHJpbnQoY2xpZW50LnNob3dfa2V5cygpKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIHByb21wdC5sb3dlcigpID09ICJjbGVhciI6CiAgICAgICAgICAgICAgICAjIGNsZWFyIGhpc3RvcnkgKG5vdCB0aGUgc2F2ZWQgY29uZmlnKQogICAgICAgICAgICAgICAgY2xpZW50Lmhpc3RvcnkgPSBbXQogICAgICAgICAgICAgICAgc2F2ZV9oaXN0b3J5KGNsaWVudC5oaXN0b3J5KQogICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArICJDb252ZXJzYXRpb24gaGlzdG9yeSBjbGVhcmVkLiIpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgaWYgcHJvbXB0Lmxvd2VyKCkgPT0gImhpc3RvcnkiOgogICAgICAgICAgICAgICAgaGlzdCA9IGNsaWVudC5oaXN0b3J5IG9yIFtdCiAgICAgICAgICAgICAgICBwcmludChGb3JlLkNZQU4gKyAiQ29udmVyc2F0aW9uIGhpc3RvcnkgKHJvbGUgLT4gY29udGVudCk6IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgICAgICAgICAgICAgIGZvciBpLCBtIGluIGVudW1lcmF0ZShoaXN0KToKICAgICAgICAgICAgICAgICAgICByb2xlID0gbS5nZXQoInJvbGUiLCAiPyIpCiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IG0uZ2V0KCJjb250ZW50IiwgIiIpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyBmIlt7aX1dIHtyb2xlfTogIiArIFN0eWxlLlJFU0VUX0FMTCArIGNvbnRlbnRbOjEwMF0ucmVwbGFjZSgiXG4iLCAiICIpKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIHByb21wdC5sb3dlcigpLnN0YXJ0c3dpdGgoInNldHByb21wdCAiKToKICAgICAgICAgICAgICAgIG5ldyA9IHByb21wdFtsZW4oInNldHByb21wdCAiKTpdLnN0cmlwKCkKICAgICAgICAgICAgICAgIGlmIG5ldzoKICAgICAgICAgICAgICAgICAgICBjbGllbnQuc3lzdGVtX3Byb21wdCA9IG5ldwogICAgICAgICAgICAgICAgICAgIGNsaWVudC5jZmdbJ3N5c3RlbV9wcm9tcHQnXSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHNhdmVfY29uZmlnKGNsaWVudC5jZmcpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArICJTeXN0ZW0gcHJvbXB0IHVwZGF0ZWQuIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyAiVXNhZ2U6IHNldHByb21wdCA8dGV4dD4iKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIHByb21wdC5sb3dlcigpLnN0YXJ0c3dpdGgoInNldG1vZGVsICIpOgogICAgICAgICAgICAgICAgbmV3ID0gcHJvbXB0W2xlbigic2V0bW9kZWwgIik6XS5zdHJpcCgpCiAgICAgICAgICAgICAgICBpZiBuZXc6CiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm1vZGVsID0gbmV3CiAgICAgICAgICAgICAgICAgICAgY2xpZW50LmNmZ1snbW9kZWwnXSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHNhdmVfY29uZmlnKGNsaWVudC5jZmcpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIGYiTW9kZWwgdXBkYXRlZCB0byB7bmV3fS4iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLllFTExPVyArICJVc2FnZTogc2V0bW9kZWwgPG1vZGVsX25hbWU+IikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIFJlZ3VsYXIgY2hhdAogICAgICAgICAgICBhbnN3ZXIgPSBjbGllbnQuY2hhdChwcm9tcHQpCiAgICAgICAgICAgICMgbmljZSBwcmludAogICAgICAgICAgICBwcmludChGb3JlLk1BR0VOVEEgKyAiXG5DaGF0R1BUPiAiICsgU3R5bGUuUkVTRVRfQUxMICsgYW5zd2VyKQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChGb3JlLlJFRCArICJGYXRhbCBlcnJvcjogIiArIHN0cihlKSkKICAgIGZpbmFsbHk6CiAgICAgICAgc2F2ZV9oaXN0b3J5KGNsaWVudC5oaXN0b3J5KQogICAgICAgIHNhdmVfY29uZmlnKGNsaWVudC5jZmcpCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSBGaXJzdC10aW1lIHNldHVwIC0tLS0tLS0tLS0tLS0tLS0tLS0tLQpkZWYgZmlyc3RfdGltZV9zZXR1cChjbGllbnQ6IENHUFRDbGllbnQpOgogICAgcHJpbnRfaGVhZGVyKGNsaWVudCkKICAgIHByaW50KEZvcmUuQ1lBTiArICJGaXJzdC10aW1lIHNldHVwOiIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBwcmludCgiRGV0ZWN0ZWQgbXVsdGlwbGUgQVBJIGtleXMuIENob29zZSBkZWZhdWx0IGtleSBpbmRleCB0byB1c2Ugb24gc3RhcnR1cC4iKQogICAgZm9yIGksIGsgaW4gZW51bWVyYXRlKGNsaWVudC5hcGlfa2V5cyk6CiAgICAgICAgZGVmYXVsdF9tYXJrZXIgPSAiPC0tIiBpZiBpID09IGNsaWVudC5rZXlfaW5kZXggZWxzZSAiIgogICAgICAgIHByaW50KGYiICBbe2l9XSB7bWFza19rZXkoayl9IHtkZWZhdWx0X21hcmtlcn0iKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNob2ljZSA9IGlucHV0KEZvcmUuV0hJVEUgKyAiU2VsZWN0IGtleSBpbmRleCAob3IgcHJlc3MgRW50ZXIgdG8ga2VlcCBjdXJyZW50KTogIiArIFN0eWxlLlJFU0VUX0FMTCkuc3RyaXAoKQogICAgICAgIGV4Y2VwdCAoRU9GRXJyb3IsIEtleWJvYXJkSW50ZXJydXB0KToKICAgICAgICAgICAgcHJpbnQoIlxuQWJvcnRlZCBzZXR1cC4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBjaG9pY2UgPT0gIiI6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgaWYgY2hvaWNlLmlzZGlnaXQoKToKICAgICAgICAgICAgaWR4ID0gaW50KGNob2ljZSkKICAgICAgICAgICAgaWYgMCA8PSBpZHggPCBsZW4oY2xpZW50LmFwaV9rZXlzKToKICAgICAgICAgICAgICAgIGNsaWVudC5zZXRfa2V5KGlkeCkKICAgICAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIkRlZmF1bHQga2V5IHNldCB0byBpbmRleCB7aWR4fS4iKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KEZvcmUuWUVMTE9XICsgIkluZGV4IG91dCBvZiByYW5nZS4iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KEZvcmUuWUVMTE9XICsgIlBsZWFzZSBlbnRlciBhIHZhbGlkIG51bWJlci4iKQogICAgIyBBc2sgdG8gc2V0IHN5c3RlbSBwcm9tcHQKICAgIHRyeToKICAgICAgICBzcCA9IGlucHV0KEZvcmUuV0hJVEUgKyAiT3B0aW9uYWw6IGN1c3RvbSBzeXN0ZW0gcHJvbXB0IChFbnRlciB0byBza2lwKTogIiArIFN0eWxlLlJFU0VUX0FMTCkuc3RyaXAoKQogICAgICAgIGlmIHNwOgogICAgICAgICAgICBjbGllbnQuc3lzdGVtX3Byb21wdCA9IHNwCiAgICAgICAgICAgIGNsaWVudC5jZmdbJ3N5c3RlbV9wcm9tcHQnXSA9IHNwCiAgICAgICAgICAgIHNhdmVfY29uZmlnKGNsaWVudC5jZmcpCiAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyAiU3lzdGVtIHByb21wdCBzYXZlZC4iKQogICAgZXhjZXB0IChFT0ZFcnJvciwgS2V5Ym9hcmRJbnRlcnJ1cHQpOgogICAgICAgIHBhc3MKCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tIE1haW4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmRlZiBtYWluKCk6CiAgICBjbGllbnQgPSBDR1BUQ2xpZW50KEFQSV9LRVlTKQogICAgIyBJZiBjb25maWcgZGlkbid0IGV4aXN0LCBydW4gZmlyc3QtdGltZSBzZXR1cAogICAgaWYgbm90IENPTkZJR19QQVRILmV4aXN0cygpOgogICAgICAgIGZpcnN0X3RpbWVfc2V0dXAoY2xpZW50KQogICAgaW50ZXJhY3RpdmVfbG9vcChjbGllbnQpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg=="""

exec(compile(base64.b64decode(code), "<string>", "exec"))
